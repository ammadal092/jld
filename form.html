<!DOCTYPE html>
<html lang="ja">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta charset="UTF-8">
    <title>å…¥åŠ›ã«åŸºã¥ãç”»åƒè¡¨ç¤º</title>
    <style>
        img {
            max-width: 500px;
            margin-top: 20px;
        }
        .furigana, .meaning {
            display: none;
            margin-top: 10px;
            color: #333;
        }
        button {
            margin-top: 10px;
        }
        .not-found {
            color: red;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>ç”»åƒã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã«æ¼¢å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h1>
    <form id="kanjiForm">
        <label for="kanji">æ¼¢å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„: </label>
        <input type="text" id="kanji" name="kanji" required>
        <button type="submit">æ¤œç´¢</button>
    </form>

    <h2>æ¤œç´¢çµæœ:</h2>
    <div id="imageResults"></div>
    <div id="notFoundResults" class="not-found"></div>

    <div id="furiganaResults">
        <button id="showFurigana">ãµã‚ŠãŒãªã‚’è¡¨ç¤º</button>
        <div class="furigana" id="furiganaText"></div>
    </div>
    
    <div id="meaningResults">
        <button id="showMeaning">æ„å‘³ã‚’è¡¨ç¤º</button>
        <div class="meaning" id="meaningText"></div>
    </div>
    <script>
    document.getElementById('kanjiForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const inputText = document.getElementById('kanji').value.trim();
        const imageContainer = document.getElementById('imageResults');
        const notFoundContainer = document.getElementById('notFoundResults');
        imageContainer.innerHTML = '';
        notFoundContainer.innerHTML = '';

        const folderPath = 'æ¼¢å­—/';
        const extensions = ['.png', '.jpg'];
        const maxSuffix = 1;

        const foundImages = [];
        const kanjiFound = {};
        let totalToCheck = 0;
        let totalChecked = 0;

        // ğŸ”¹ Ambil hanya karakter kanji unik
        const uniqueKanji = [...new Set(inputText.split(''))];

        for (let kanjiChar of uniqueKanji) {
            kanjiFound[kanjiChar] = false;

            for (let ext of extensions) {
                checkImage(kanjiChar, folderPath + kanjiChar + ext);
                for (let i = 1; i <= maxSuffix; i++) {
                    let num = String(i).padStart(3, '0');
                    checkImage(kanjiChar, folderPath + kanjiChar + num + ext);
                }
            }
        }

        function checkImage(kanjiChar, path) {
            totalToCheck++;
            const timestamp = Date.now();
            const pathWithTimestamp = `${path}?t=${timestamp}`;
            let img = new Image();
            img.src = pathWithTimestamp;

            img.onload = function () {
                if (!kanjiFound[kanjiChar]) {
                    kanjiFound[kanjiChar] = true;
                }
                if (!foundImages.includes(pathWithTimestamp)) {
                    foundImages.push(pathWithTimestamp);
                }
                checkDone();
            };

            img.onerror = function () {
                checkDone();
            };
        }

        function checkDone() {
            totalChecked++;
            if (totalChecked === totalToCheck) {
                displayResults();
            }
        }

        function displayResults() {
            if (foundImages.length === 0) {
                imageContainer.innerHTML = `<p style="color:red;">å…¥åŠ›ã•ã‚ŒãŸæ¼¢å­—ã«è©²å½“ã™ã‚‹ç”»åƒã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>`;
            } else {
                foundImages.forEach(function(image) {
                    imageContainer.innerHTML += `<img src="${image}" alt="ç”»åƒ">`;
                });
            }

            let notFoundList = [];
            for (let char in kanjiFound) {
                if (!kanjiFound[char]) {
                    notFoundList.push(char);
                }
            }

            if (notFoundList.length > 0) {
                notFoundContainer.innerHTML = `ç”»åƒãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸæ¼¢å­—: <strong>${notFoundList.join(', ')}</strong>`;
            }
        }
    });
</script>


    <!-- <script>
        document.getElementById('kanjiForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const inputText = document.getElementById('kanji').value.trim();
            const imageContainer = document.getElementById('imageResults');
            const notFoundContainer = document.getElementById('notFoundResults');
            imageContainer.innerHTML = '';
            notFoundContainer.innerHTML = '';

            const folderPath = 'æ¼¢å­—/';
            const extensions = ['.png', '.jpg'];
            const maxSuffix = 1;

            const foundImages = [];
            const kanjiFound = {};
            let totalToCheck = 0;
            let totalChecked = 0;

            // ğŸ”¹ Ambil hanya karakter kanji unik
            const uniqueKanji = [...new Set(inputText.split(''))];

            for (let kanjiChar of uniqueKanji) {
                kanjiFound[kanjiChar] = false;

                for (let ext of extensions) {
                    checkImage(kanjiChar, folderPath + kanjiChar + ext);
                    for (let i = 1; i <= maxSuffix; i++) {
                        let num = String(i).padStart(3, '0');
                        checkImage(kanjiChar, folderPath + kanjiChar + num + ext);
                    }
                }
            }

            function checkImage(kanjiChar, path) {
                totalToCheck++;
                let img = new Image();
                img.src = path;

                img.onload = function () {
                    if (!kanjiFound[kanjiChar]) {
                        kanjiFound[kanjiChar] = true;
                    }
                    if (!foundImages.includes(path)) {
                        foundImages.push(path);
                    }
                    checkDone();
                };

                img.onerror = function () {
                    checkDone();
                };
            }

            function checkDone() {
                totalChecked++;
                if (totalChecked === totalToCheck) {
                    displayResults();
                }
            }

            function displayResults() {
                if (foundImages.length === 0) {
                    imageContainer.innerHTML = `<p style="color:red;">å…¥åŠ›ã•ã‚ŒãŸæ¼¢å­—ã«è©²å½“ã™ã‚‹ç”»åƒã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>`;
                } else {
                    foundImages.forEach(function(image) {
                        imageContainer.innerHTML += `<img src="${image}" alt="ç”»åƒ">`;
                    });
                }

                let notFoundList = [];
                for (let char in kanjiFound) {
                    if (!kanjiFound[char]) {
                        notFoundList.push(char);
                    }
                }

                if (notFoundList.length > 0) {
                    notFoundContainer.innerHTML = `ç”»åƒãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸæ¼¢å­—: <strong>${notFoundList.join(', ')}</strong>`;
                }
            }
        });
    </script> -->


</body>
</html>
